---
title: How to Integrate with the Ethereum Blockchain using iOS
sidebarTitle: iOS
---

### Installation

To interact with the Ethereum blockchain, Magic iOS SDK embeds [`Web3.swift`](https://github.com/Boilertalk/Web3.swift) as a sub-dependency. No more extra dependency is needed.

### Initialization

The Magic class is the entry-point to the Magic SDK. It must be instantiated with a Magic **publishable** key.

<Note>
**Note**

Following example is using Swift 5 with XCode 11. IOS demo will be open-sourced soon.

</Note>

<Tabs>
<Tab title="Swift">
```json

// AppDelegate.swift

import MagicSDK
import UIKit

@UIApplicationMain
func application(\_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {

    // assign the newly created Magic instance to shared property
    Magic.shared = Magic("YOUR_PUBLISHABLE_API_KEY");

    return true

}

````
</Tab>
</Tabs>

<Tabs>
<Tab title="Swift">
```json

// ViewController.swift

import UIKit
import MagicSDK
import MagicSDK_Web3

class Web3ViewController: UIViewController {

    let web3 = Web3(provider: Magic.shared.rpcProvider)
}
````

</Tab>
</Tabs>

### Use Different Networks

### Testnet

Goerli Block Explorer: [https://goerli.etherscan.io](https://goerli.etherscan.io/)

Goerli Testnet Faucet: [https://goerlifaucet.com](https://goerlifaucet.com/)

<Tabs>
<Tab title="Swift">
```json

// AppDelegate.swift
import MagicSDK

func application(\_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {

    // assign to Magic singleton
    Magic.shared = Magic("YOUR_PUBLISHABLE_API_KEY", EthNetwork.rinkeby);

    return true

}

````
</Tab>
</Tabs>

### Custom Node

You can allow specific URLs to interact with the Magic SDK, such as a custom RPC URL to send transactions to your node. The Content Security Policy (CSP) of a browser dictates what resources can be loaded. You can update the policy in the settings page of the dashboard with your custom URL.

<Note>
**Note**


Note: the use of a custom node will require the RPC URL to the project's Content Security Policy from your [Magic dashboard](https://dashboard.magic.link/). Refer to the [CSP documentation](/docs/embedded-wallet/wallets/security/content-security-policy).
</Note>

<Tabs>
<Tab title="Swift">
```json

// AppDelegate.swift
import MagicSDK

// assign to Magic singleton
func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {

    let config = CustomNodeConfiguration(rpcUrl: "https://alchemy.io", chainId: 1)
    Magic.shared = Magic(apiKey: "API_KEY", customNode: config);

    return true
}
````

</Tab>
</Tabs>

<Info>
**Important**

Do **not** set the custom nodes to local IP address (E.x. "[http://127.0.0.1"](http://127.0.0.1")). Local IP will point to the network environment inside mobile device / simulator

</Info>

### Associated Class

`CustomNodeConfiguration(rpcUrl: String, chainId: Int?)`

- `rpcUrl` :Your own node URL
- `chainId` : Your own node's chainId

`EthNetwork`

<Tabs>
<Tab title="Swift">
```json

public enum EthNetwork: String {
case mainnet
case goerli
}

````
</Tab>
</Tabs>

### Common Methods

### Send Transaction

<Tabs>
<Tab title="Swift">
```json

import MagicSDK
import MagicSDK_Web3

class Web3ViewController: UIViewController {

    var web3 = Web3(provider: Magic.shared.rpcProvider)
    var account: EthereumAddress?

    // ⭐️ After user is successfully authenticated
    func sendTransaction() {

        guard let account = self.account else { return }

        // Construct a transaction
        let transaction = EthereumTransaction(
            from: account, // from Get User Info section
            to: EthereumAddress(hexString: "0xE0cef4417a772512E6C95cEf366403839b0D6D6D"),
            value: EthereumQuantity(quantity: 1.gwei)
        )

        // Submit transaction to the blockchain
        web3.eth.sendTransaction(transaction: transaction).done { (transactionHash) in
            print(transactionHash.hex())
        }.catch { error in
            print(error.localizedDescription)
        }
    }
}
````

</Tab>
</Tabs>

### Sign Message

Magic iOS SDK extends the functionality from Web3.swift to allow developers to sign Typed Data. Make sure to `import MagicSDK` while using these functions.

### Eth Sign

<Tabs>
<Tab title="Swift">
```json

import MagicSDK
import MagicSDK_Web3
import PromiseKit

class ViewController: UIViewController {

    let web3 = Web3(provider: Magic.shared.rpcProvider)
    var account: EthereumAddress?

    func ethSign() {
        guard let account = self.account else { return }

        let message = try! EthereumData("Hello World".data(using: .utf8)!)
        web3.eth.sign(from: account, message: message).done({ result in
            print(result.hex())
        })
    }

}

````
</Tab>
</Tabs>

### [#Sign Typed Data Legacy (V1)](#sign-typed-data-legacy-v-1)

<Tabs>
<Tab title="Swift">
```json

import MagicSDK
import MagicSDK_Web3
import PromiseKit

class Web3ViewController: UIViewController {

    let web3 = Web3(provider: Magic.shared.rpcProvider)
    var account: EthereumAddress?

    func SignTypedDataLegacy() {
        guard let account = self.account else { return }

        let payload = EIP712TypedDataLegacyFields(type: "string", name: "Hello from Magic Labs", value: "This message will be signed by you")

        web3.eth.signTypedDataLegacy(account: account, data: [payload]).done({ result in
            print(result.hex())
        })
    }
}
````

</Tab>
</Tabs>

### [#Sign Typed Data v3(EIP 712)](#sign-typed-data-v-3-eip-712)

<Tabs>
<Tab title="Swift">
```json

import MagicSDK
import MagicSDK_Web3

class Web3ViewController: UIViewController {

    let web3 = Web3(provider: Magic.shared.rpcProvider)
    var account: EthereumAddress?

    func SignTypedData() {
        guard let account = self.account else { return }

        do {
            let json = """
                {"types":{"EIP712Domain":[{"name":"name","type":"string"},{"name":"version","type":"string"},{"name":"verifyingContract","type":"address"}],"Greeting":[{"name":"contents","type":"string"}]},"primaryType":"Greeting","domain":{"name":"Magic","version":"1","verifyingContract":"0xE0cef4417a772512E6C95cEf366403839b0D6D6D"},"message":{"contents":"Hello, from Magic!"}}
            """.data(using: .utf8)!
            let typedData = try JSONDecoder().decode(EIP712TypedData.self, from: json)

            web3.eth.signTypedData(account: account, data: typedData).done({ result in
                print(result.hex())
            })
        } catch {
            print(error.localizedDescription)
        }
    }

}

````
</Tab>
</Tabs>

### Sign Typed Data V4 (EIP 712)

<Tabs>
<Tab title="Swift">
```json

import MagicSDK
import MagicSDK_Web3

class Web3ViewController: UIViewController {

    let web3 = Web3(provider: Magic.shared.rpcProvider)
    var account: EthereumAddress?

    func SignTypedData() {
        guard let account = self.account else { return }

        do {
            let json = """
            {"domain":{"chainId":1,"name":"Ether Mail","verifyingContract":"0xCcCCccccCCCCcCCCCCCcCcCccCcCCCcCcccccccC","version":"1"},"message":{"contents":"Hello, Bob!","from":{"name":"Cow","wallets":["0xCD2a3d9F938E13CD947Ec05AbC7FE734Df8DD826","0xDeaDbeefdEAdbeefdEadbEEFdeadbeEFdEaDbeeF"]},"to":[{"name":"Bob","wallets":["0xbBbBBBBbbBBBbbbBbbBbbbbBBbBbbbbBbBbbBBbB","0xB0BdaBea57B0BDABeA57b0bdABEA57b0BDabEa57","0xB0B0b0b0b0b0B000000000000000000000000000"]}]},"primaryType":"Mail","types":{"EIP712Domain":[{"name":"name","type":"string"},{"name":"version","type":"string"},{"name":"chainId","type":"uint256"},{"name":"verifyingContract","type":"address"}],"Group":[{"name":"name","type":"string"},{"name":"members","type":"Person[]"}],"Mail":[{"name":"from","type":"Person"},{"name":"to","type":"Person[]"},{"name":"contents","type":"string"}],"Person":[{"name":"name","type":"string"},{"name":"wallets","type":"address[]"}]}}
            """.data(using: .utf8)!
            let typedData = json.data(using: .utf8)!
            let typedDataV4 = try JSONDecoder().decode(EIP712TypedData.self, from: typedData)
            web3.eth.signTypedDataV4(account: address, data: typedDataV4).done({ response in
                print(response.hex())
            })
        // Catch decoding error
        } catch let DecodingError.typeMismatch(type, context)  {
               print("Type '\(type)' mismatch:", context.debugDescription)
               print("codingPath:", context.codingPath)
        } catch {
            self.showResult(error.localizedDescription)
        }
    }
}
````

</Tab>
</Tabs>

### Get User Info

<Tabs>
<Tab title="Swift">
```json

import MagicSDK
import MagicSDK_Web3
import PromiseKit

class Web3ViewController: UIViewController {

    var web3 = Web3(provider: Magic.shared.rpcProvider)

    // ⭐️ After user is successfully authenticated
    @IBOutlet weak var accountLabel: UILabel!

    func getAccount() {

        firstly {
            // Get user's Ethereum public address
            web3.eth.accounts()
        }.done { accounts -> Void in
            if let account = accounts.first {
                // Set to UILa
                self.accountLabel.text = account.hex(eip55: false)
            } else {
                print("No Account Found")
            }
        }.catch { error in
            print("Error loading accounts and balance: \(error)")
        }
    }

}

````
</Tab>
</Tabs>

### Smart Contract

In this example, we'll be demonstrating how to use Magic with Web3.swift to interact with Solidity smart contracts. The simple Hello World contract allows anyone to read and write a message to it.

<Tabs>
<Tab title="Javascript">
```json

pragma solidity ^0.5.10;

contract HelloWorld {

  string public message;

  constructor(string memory initMessage) public {
    message = initMessage;
  }

  function update(string memory newMessage) public {
    message = newMessage;
  }
}
````

</Tab>
</Tabs>

### Deploy Contract

<Tabs>
<Tab title="Swift">
```json
Swift

````
</Tab>
</Tabs>

### Read From Contract

<Tabs>
<Tab title="Swift">
```json
Swift

````

</Tab>
</Tabs>

### Write to Contract

<Tabs>
<Tab title="Swift">
```json

import MagicSDK
import MagicSDK_Web3

class MagicViewController: UIViewController {

    let web3 = Web3(provider: Magic.shared.rpcProvider)
    var account: EthereumAddress?

    // ⭐️ After user is successfully authenticated

    func writeMessage() {

        guard let account = self.account else { return }

        do {
            /// contract instance
            let contractABI = """
                [{"constant":false,"inputs":[{"name":"newMessage","type":"string"}],"name":"update","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"message","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[{"name":"initMessage","type":"string"}],"payable":false,"stateMutability":"nonpayable","type":"constructor"}]
            """.data(using: .utf8)!
            let contract = try web3.eth.Contract(json: contractABI, abiKey: nil, address: EthereumAddress(ethereumValue: "0x8b211dfebf490a648f6de859dfbed61fa22f35e0"))

            /// contract call
            guard let transaction = contract["update"]?("NEW_MESSAGE").createTransaction(
                nonce: 0,
                from: account,
                value: 0,
                gas: EthereumQuantity(150000),
                gasPrice: EthereumQuantity(quantity: 21.gwei)
                ) else { return }

            web3.eth.sendTransaction(transaction: transaction).done({ txHash in
                print(txHash.hex())
            }).catch{ error in
                print(error.localizedDescription)
            }
        } catch {
            print(error.localizedDescription)
        }
    }

}

```
</Tab>
</Tabs>

### Resources

* [Magic iOS SDK](https://github.com/magiclabs/magic-ios)
* [Magic iOS Demo](https://github.com/magiclabs/magic-ios-demo)
```
