---
title: Python API Reference
sidebarTitle: Python
---

## Overview

The Magic package for Python is your entry-point to secure, passwordless authentication for your application. This guide will cover some important topics for getting started with Magic Python package and to make the most of Magic's features.

## Getting Started

The Magic class is the entry-point to the Magic SDK. It must be instantiated with a Magic **secret** key.

### Installation

Current SDK is built with Python3.6. Testing for Python3.6+ will be added soon.

<Note>
  If you are interested in using the SDK with the earlier versions of Python
  (ex: 2.7+), please create a ticket in this
  [repo](https://github.com/fortmatic/magic-admin-python) and let us know.
</Note>

<Tabs>
<Tab title="PHP">
```json
pip install magic-admin

````
</Tab>
<Tab title="Conda">
```json
conda install magic-admin
````

</Tab>
</Tabs>

### Constructor

**`Magic()`**

|                   |      |                                                               |
| ----------------- | ---- | ------------------------------------------------------------- |
| Parameter         | Type | Definition                                                    |
| `api_secret_key`  | str  | Your **secret** API Key retrieved from the Magic Dashboard.   |
| `retries?`        | num  | Total number of retries to allow.                             |
| `timeout?`        | num  | A period of time the request is going to wait for a response. |
| `backoff_factor?` | num  | A backoff factor to apply between retry attempts.             |

#### Initialization

Initialize Magic instance.

<Tabs>
<Tab title="Python">
```json

from magic_admin import Magic

magic = Magic(
api_secret_key='<SECRET_API_KEY>',
retries=5,
timeout=5,
backoff_factor=0.01,
)

````
</Tab>
</Tabs>

## Token Resource

The token resource and its methods are accessible on the Magic instance by the `Token` attribute. It provides methods to interact with the DID Token.

<Note>
The token resource does **not** make any API calls to the Magic server.
</Note>

<Tabs>
<Tab title="Python">
```json

from magic_admin import Magic

magic = Magic(api_secret_key='<SECRET_API_KEY>')

magic.Token
magic.Token.get_issuer
magic.Token.get_public_address
magic.Token.decode
magic.Token.validate
````

</Tab>
</Tabs>

### `get_issuer`

Extracts the `iss` from the [DID Token](/docs/authentication/features/decentralized-id).

<Tabs>
<Tab title="Python">
```json

Token.get_issuer(did_token)

````
</Tab>
</Tabs>

#### Arguments

* `did_token` (str): A DID Token generated by a Magic User on the client-side

#### Raises

* `DIDTokenMalformed` if the given DID Token is malformed

#### Returns

* A Decentralized ID (`iss`) of the Magic user who generated the DID Token

### `get_public_address`

Gets the cryptographic [public address](https://support.blockchain.com/hc/en-us/articles/4417082520724-What-are-public-and-private-keys-and-how-do-they-work-) of the Magic User who generated the supplied DID Token.

<Tabs>
<Tab title="Python">
```json

Token.get_public_address(did_token)
````

</Tab>
</Tabs>

#### Arguments

- `did_token` (str): A DID Token generated by a Magic user on the client-side

#### Raises

- `DIDTokenMalformed` if the given DID Token is malformed

#### Returns

- A [public address](https://support.blockchain.com/hc/en-us/articles/4417082520724-What-are-public-and-private-keys-and-how-do-they-work-) of the Magic User who generated the DID Token. Currently, this value is associated with the Ethereum blockchain.

### `decode`

Decodes a DID Token from a Base64 string into a tuple of its individual components: `proof` and `claim`. This method allows you decode the DID Token and inspect the token. You can apply your own rules and validations on top of the current [Token.validate](#validate) method.

<Tabs>
<Tab title="Python">
```json

Token.decode(did_token)

````
</Tab>
</Tabs>

#### Arguments

* `did_token` (str): A DID Token generated by a Magic user on the client-side

#### Raises

* `DIDTokenMalformed` if the given DID Token is malformed

#### Returns

* `proof` (str): A digital signature that proves the validity of the given `claim`
* `claim` (dict): Unsigned data the user asserts. This should equal the `proof` after Elliptic Curve recovery. See [Decentralized ID Token Specification](/docs/authentication/features/decentralized-id#decentralized-id-token-specification) for fields inside the `claim`.

### `validate`

Validates a DID token.

<Tabs>
<Tab title="Python">
```json

magic.Token.validate(did_token)
````

</Tab>
</Tabs>

#### Arguments

- `did_token` (str): A DID Token generated by a Magic user on the client-side

#### Raises

- `DIDTokenMalformed` if the given DID Token is malformed
- `DIDTokenInvalid` if the given DID Token is invalid

#### Returns

- _None._

## User Resource

The user resource and its methods are accessible on the Magic instance by the `User` attribute. It provides methods to interact with the User.

<Tabs>
<Tab title="Python">
```json

from magic_admin import Magic

magic = Magic(api_secret_key='<SECRET_API_KEY>')

magic.User
magic.User.get_metadata_by_issuer
magic.User.get_metadata_by_public_address
magic.User.get_metadata_by_token
magic.User.logout_by_issuer
magic.User.logout_by_public_address
magic.User.logout_by_token

````
</Tab>
</Tabs>

### `get_metadata_by_issuer`

Retrieves information about the user by the supplied `iss` from the DID Token. This method is useful if you store the `iss` with your user data, **which is recommended**.

<Tabs>
<Tab title="Python">
```json

User.get_metadata_by_issuer(issuer)
````

</Tab>
</Tabs>

#### Arguments

- `issuer` (str): The user's Decentralized ID, which can be parsed using [Token.get_issuer](#get_issuer)

#### Raises

- `RateLimitingError`: If you have sent too many requests within a given period of time
- `BadRequestError`: If the supplied parameters are invalid
- `AuthenticationError`: If your API **secret** key cannot be authenticated with Magic API server
- `ForbiddenError`: If your API **secret** key is not authorized to access the resources
- `APIError`: For any other API error
- `APIConnectionError`: If your server cannot communicate with the Magic server. Normally this is a network communication error.

<Note>
  See [Error Handling](#response-and-error-handling) for more examples.
</Note>
#### Returns

- A [`MagicResponse`](/docs/api/server-side-sdks/python#magicresponse): The `data` field contains all of the user meta information.
  - `issuer` (str): The user's Decentralized ID
  - `public_address` (str): The authenticated user's public address (a.k.a.: public key). Currently, this value is associated with the Ethereum blockchain.
  - `email` (str): The user's email address
  - `phone_number` (str): The user's phone number
  - `oauth_provider` (str): OAuth provider, if any
  - `wallets` (arr): Array of user's wallet addresses

### `get_metadata_by_public_address`

Retrieves information about the user by the supplied `public_address`. This method is useful if you store the `public_address` with your user data.

<Tabs>
<Tab title="Python">
```json

User.get_metadata_by_public_address(public_address)

````
</Tab>
</Tabs>

#### Arguments

* `public_address` (str): The user's Ethereum public address, which can be parsed using [Token.get\_public\_address](#get_public_address)

#### Raises

* `RateLimitingError`: If you have sent too many requests within a given period of time.
* `BadRequestError`: If the supplied parameters are invalid
* `AuthenticationError`: If your API **secret** key cannot be authenticated with Magic API server
* `ForbiddenError`: If your API **secret** key is not authorized to access the resources
* `APIError`: For any other API error
* `APIConnectionError`: If your server cannot communicate with the Magic server. Normally this is a network communication error.

<Note>
See [Error Handling](#response-and-error-handling) for more examples.
</Note>

#### Returns

* A [`MagicResponse`](/docs/api/server-side-sdks/python#magicresponse): The `data` field contains all of the user meta information.
    * `issuer` (str): The user's Decentralized ID
    * `public_address` (str): The authenticated user's public address (a.k.a.: public key). Currently, this value is associated with the Ethereum blockchain.
    * `email` (str): The user's email address
    * `phone_number` (str): The user's phone number
    * `oauth_provider` (str): OAuth provider, if any
    * `wallets` (arr): Array of user's wallet addresses

### `get_metadata_by_token`

Retrieves information about the user by the supplied DID Token.

<Tabs>
<Tab title="Python">
```json

User.get_metadata_by_token(did_token)
````

</Tab>
</Tabs>

#### Arguments

- `did_token` (str): A DID Token generated by a Magic User on the client-side.

#### Raises

- `RateLimitingError`: If you have sent too many requests within a given period of time
- `BadRequestError`: If the supplied parameters are invalid
- `AuthenticationError`: If your API **secret** key cannot be authenticated with Magic API server
- `ForbiddenError`: If your API **secret** key is not authorized to access the resources
- `APIError`: For any other API error
- `APIConnectionError`: If your server cannot communicate with the Magic server. Normally this is a network communication error.

<Note>
  See [Error Handling](#response-and-error-handling) for more examples.
</Note>

#### Returns

- A [`MagicResponse`](/docs/api/server-side-sdks/python#magicresponse): The `data` field contains all of the user meta information.
  - `issuer` (str): The user's Decentralized ID
  - `public_address` (str): The authenticated user's public address (a.k.a.: public key). Currently, this value is associated with the Ethereum blockchain.
  - `email` (str): The user's email address
  - `phone_number` (str): The user's phone number
  - `oauth_provider` (str): OAuth provider, if any
  - `wallets` (arr): Array of user's wallet addresses

### `logout_by_issuer`

Logs a user out of all Magic SDK sessions given the user's Decentralized ID (`iss`). This method is useful if you store the `iss` with your user data, which is recommended.

<Tabs>
<Tab title="Python">
```json

User.logout_by_issuer(issuer)

````
</Tab>
</Tabs>

#### Arguments

* `issuer` (str): The user's Decentralized ID, which can be parsed using [Token.get_issuer](#get_issuer)

#### Raises

* `RateLimitingError`: If you have sent too many requests within a given period of time
* `BadRequestError`: If the supplied parameters are invalid
* `AuthenticationError`: If your API **secret** key cannot be authenticated with Magic API server
* `ForbiddenError`: If your API **secret** key is not authorized to access the resources
* `APIError`: For any other API error
* `APIConnectionError`: If your server cannot communicate with the Magic server. Normally this is a network communication error.

<Note>
See [Error Handling](#response-and-error-handling) for more examples.
</Note>
#### Returns

* A [`MagicResponse`](/docs/api/server-side-sdks/python#magicresponse)

### `logout_by_public_address`

Logs a user out of all Magic SDK sessions given the user's public address. This method is useful if you store the `public_address`.

<Tabs>
<Tab title="Python">
```json

User.logout_by_public_address(public_address)
````

</Tab>
</Tabs>

#### Arguments

- `public_address` (str): The user's Ethereum public address

#### Raises

- `RateLimitingError`: If you have sent too many requests within a given period of time
- `BadRequestError`: If the supplied parameters are invalid
- `AuthenticationError`: If your API **secret** key cannot be authenticated with Magic API server
- `ForbiddenError`: If your API **secret** key is not authorized to access the resources
- `APIError`: For any other API error
- `APIConnectionError`: If your server cannot communicate with the Magic server. Normally this is a network communication error.

<Note>
  See [Error Handling](#response-and-error-handling) for more examples.
</Note>

#### Returns

- A [`MagicResponse`](/docs/api/server-side-sdks/python#magicresponse)

### `logout_by_token`

Logs a user out of all Magic SDK sessions given the DID Token.

<Tabs>
<Tab title="Python">
```json

User.logout_by_token(did_token)

````
</Tab>
</Tabs>

#### Arguments

* `did_token` (str): A DID Token generated by a Magic user on the client-side

#### Raises

* `RateLimitingError`: If you have sent too many requests within a given period of time
* `BadRequestError`: If the supplied parameters are invalid
* `AuthenticationError`: If your API **secret** key cannot be authenticated with Magic API server
* `ForbiddenError`: If your API **secret** key is not authorized to access the resources
* `APIError`: For any other API error
* `APIConnectionError`: If your server cannot communicate with the Magic server. Normally this is a network communication error.


<Note>
See [Error Handling](#response-and-error-handling) for more examples.
</Note>
#### Returns

* A [`MagicResponse`](/docs/api/server-side-sdks/python#magicresponse)

### Response and Error Handling

#### Response

There is only one response object that will be returned from a successful API call.

#### MagicResponse

This is the interface to interact Magic API responses. It will only be returned if the API request status code is between 200 (inclusive) and 300 (exclusive).

You will have access to the following attributes:

* `content` (bytes): Raw content returned by the API response
* `status_code` (num): HTTP status code for the given request
* `data` (dict): Parsed content

<Tabs>
<Tab title="Python">
```json

from magic_admin.response import MagicResponse

MagicResponse.content
MagicResponse.status
MagicResponse.data
````

</Tab>
</Tabs>

#### Errors

The conventional HTTP response is adopted by the SDK. For the status code in:

- `2XX` \- Indicates success
- `4XX` \- Indicates client errors. Information provided to the SDK is invalid.
- `5XX` \- Indicates server errors

Below is the error class inheritance which can help developers to programmatically handle the error cases.

```json

MagicError
    |
    |------- RequestError
                  |
                  | ------- RateLimitingError
                  | ------- BadRequestError
                  | ------- AuthenticationError
                  | ------- ForbiddenError
                  | ------- APIError
                  | ------- APIConnectionError
   |
   | ------- DIDTokenInvalid
   |
   | ------- DIDTokenMalformed
   |
   | ------- DIDTokenExpired
```

#### MagicError

This is the base class of all the Magic SDK errors.

<Tabs>
<Tab title="Python">
```json

MagicError(message=None)

````
</Tab>
</Tabs>

#### RequestError

This is the base class of all the Magic API request errors. This error class will provide details of unsuccessful API requests.

<Tabs>
<Tab title="Python">
```json

RequestError(
    message=None, http_status=None, http_code=None, http_resp_data=None,
    http_message=None, http_error_code=None, http_request_params=None,
    http_request_data=None, http_method=None,
)
````

</Tab>
</Tabs>

|      |                       |                                                                                                                                           |
| ---- | --------------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |
| Code | Error                 | Description                                                                                                                               |
| 429  | `RateLimitingError`   | Too many requests are submitted for a given period of time.                                                                               |
| 400  | `BadRequestError`     | The API requests might have missing required fields or bad inputs.                                                                        |
| 401  | `AuthenticationError` | This means your API **secret** key is invalid.                                                                                            |
| 403  | `ForbiddenError`      | This normally means the given API **secret** key doesn't have permission to perform the action on the given resources.                    |
| –    | `APIError`            | This is a generic API error that handles other status codes that are not explicitly handled. Ex: `500` , `404` , etc.                     |
| –    | `APIConnectionError`  | Network connection error. This normally means the connection between between your application and Magic API server cannot be established. |

#### DIDTokenInvalid

This means the given token fails the validation.

#### DIDTokenMalformed

This means the given token format is invalid.

#### DIDTokenExpired

This means the given token has expired.

#### Error Handling

It is recommended to implement error handling for API responses.

<Tabs>
<Tab title="Python">
```json

try: # Make requests to Magic server.
except RateLimitingError as e:
pass
except BadRequestError as e:
pass
except AuthenticationError as e:
pass
except ForbiddenError as e:
pass
except APIError as e:
pass
except APIConnectionError as e:
pass
except DIDTokenInvalid as e:
pass
except DIDTokenMalformed as e:
pass
except DIDTokenExpired as e:
pass

```
</Tab>
</Tabs>

## Resources

* [GitHub](https://github.com/magiclabs/magic-admin-python)
* [Python package](https://pypi.org/project/magic-admin/)

## Versions

All changes to the SDK are covered in our [latest release notes](https://github.com/magiclabs/magic-admin-python/releases).

```
