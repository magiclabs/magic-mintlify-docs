---
title: Node API Reference
sidebarTitle: Node
---

## Overview

The Magic SDK for Node is your entry-point to secure, passwordless authentication for your application. This guide will cover some important topics for getting started with Node APIs and to make the most of Magic's features.

## Getting Started

The Magic class is the entry-point to the Magic SDK. It must be instantiated with a Magic **secret** key.

### Installation

<Tabs>
<Tab title="NPM">
```json
npm install @magic-sdk/admin

```
</Tab>
<Tab title="Yarn">
```json
yarn add @magic-sdk/admin
```
</Tab>
</Tabs>


### Constructor

### [#`Magic.init()`](#magic.init())

|     |     |     |
| --- | --- | --- |
| Parameter | Type | Definition |
| `secretApiKey` | String | Your **secret** API Key retrieved from the Magic Dashboard. |
| `options.endpoint?` | String | A URL pointing to the Magic API. You should not need to provide this value except in case you are building highly custom integration tests. |

### [#Initialization](#initialization)


<Tabs>
<Tab title="Typescript">
```json

const { Magic } = require('@magic-sdk/admin');

let magic;

// Construct with an API key:
magic = await Magic.init('SECRET_API_KEY');

// Construct with an API key plus options:
magic =  await Magic.init('SECRET_API_KEY', { endpoint: '...' });
```
</Tab>
</Tabs>

## Token Module

The Token Module and its members are accessible on the Magic Admin SDK instance by the `token` property.

<Tabs>
<Tab title="Typescript">
```json

const { Magic } = require('@magic-sdk/admin');

const magic = await Magic.init('SECRET_API_KEY');

magic.token;
magic.token.getIssuer;
magic.token.getPublicAddress;
magic.token.decode;
magic.token.validate;
```
</Tab>
</Tabs>

### `getIssuer`

### Arguments

* `didToken` (String): A [Decentralized ID Token](/docs/authentication/features/decentralized-id) generated by a Magic user on the client-side.

### Returns

* A Decentralized ID (`iss`) of the Magic user who generated the DID Token

### `getPublicAddress`

Gets the cryptographic public address of the Magic User who generated the supplied token.

### Arguments

* `didToken` (String): A Decentralized ID Token generated by a Magic user on the client-side

### Returns

* The [public address](https://support.blockchain.com/hc/en-us/articles/4417082520724-What-are-public-and-private-keys-and-how-do-they-work-) of the Magic User who generated the DID Token. Currently, this value is associated with the Ethereum blockchain.

### `decode`

Decodes a Decentralized ID Token from a Base64 string into a tuple of its individual components.

### Arguments

* `didToken` (String): A Decentralized ID Token generated by a Magic user on the client-side

### Returns

* `proof` (String): A digital signature that proves the validity of the given `claim`
* `claim` (Object): Unsigned data the user asserts. This should equal the `proof` after Elliptic Curve recovery. See [Decentralized ID Token Specification](/docs/authentication/features/decentralized-id#decentralized-id-token-specification) for fields inside the `claim`.

The `claim` is automatically parsed to the following interface:

<Tabs>
<Tab title="Typescript">
```json

interface Claim {
  iat: number; // Issued At Timestamp
  ext: number; // Expiration Timestamp
  iss: string; // Issuer of DID Token
  sub: string; // Subject
  aud: string; // Audience
  nbf: number; // Not Before Timestamp
  tid: string; // DID Token ID
  add: string; // (optional) Misc additional signed data
}
```
</Tab>
</Tabs>

As a convenience, the above interface is available to your code in [TypeScript](https://www.typescriptlang.org/):

<Tabs>
<Tab title="Typescript">
```json

import { Claim } from '@magic-sdk/admin';
```
</Tab>
</Tabs>

### `validate`

Validates a Decentralized ID token.

### Arguments

* `didToken` (String): A Decentralized ID Token generated by a Magic user on the client-side
* `attachment?` (String): Arbitrary, serialized data to be used for recovery of the `add` field on the Decentralized ID Token (Defaults to `"none"`)

### Returns

* `void`: The function will return if the specified DID token is authentic and not expired. If the token is forged or otherwise invalid, the function will throw a descriptive error.

## Users Module

<Note>
Only available with Dedicated Wallet.
</Note>

### `getMetadataByIssuer`

Retrieves information about user by the supplied "issuer".

### Arguments

* `issuer` (String): The user's Decentralized ID, which can be parsed using [`TokenModule.getIssuer`](#getissuer)

### Returns

* A `MagicUserMetadata`: The `data` field contains all of the user meta information.
    * `issuer` (String): The user's Decentralized ID
    * `publicAddress` (String): The authenticated user's public address (a.k.a.: public key). Currently, this value is associated with the Ethereum blockchain.
    * `email` (String): The user's email address
    * `phoneNumber` (String | null): The user's phone number
    * `oauthProvider` (String | null): OAuth provider, if any
    * `wallets` (Object\[\]): The multichain wallets of the authenticated user

### `getMetadataByPublicAddress`

Retrieves information about user by the supplied public address.

### Arguments

* `publicAddress` (String): The user's Ethereum public address, which can be parsed using [`TokenModule.getPublicAddress`](#getpublicaddress)

### Returns

* A `MagicUserMetadata`: The `data` field contains all of the user meta information.
    * `issuer` (String): The user's Decentralized ID
    * `publicAddress` (String): The authenticated user's public address (a.k.a.: public key). Currently, this value is associated with the Ethereum blockchain.
    * `email` (String): The user's email address
    * `phoneNumber` (String | null): The user's phone number
    * `oauthProvider` (String | null): OAuth provider, if any
    * `wallets` (Object\[\]): The multichain wallets of the authenticated user

### `getMetadataByToken`

Retrieves information about user by the supplied DID Token.

### Arguments

* `didToken` (String): A valid Decentralized ID Token generated client-side by a Magic user

### Returns

* A `MagicUserMetadata`: The `data` field contains all of the user meta information.
    * `issuer` (String): The user's Decentralized ID
    * `publicAddress` (String): The authenticated user's public address (a.k.a.: public key). Currently, this value is associated with the Ethereum blockchain.
    * `email` (String): The user's email address
    * `phoneNumber` (String | null): The user's phone number
    * `oauthProvider` (String | null): OAuth provider, if any
    * `wallets` (Object\[\]): The multichain wallets of the authenticated user

### `logoutByIssuer`

Logs a user out of all client-side Magic SDK sessions given the user's Decentralized ID.

### Arguments

* `issuer` (String): The user's Decentralized ID, which can be parsed using [`TokenModule.getIssuer`](#getissuer)

### Returns

* `Promise<void>`

### `logoutByPublicAddress`

Logs a user out of all client-side Magic SDK sessions given the user's public address.

### Arguments

* `publicAddress` (String): The user's Ethereum [public address](https://support.blockchain.com/hc/en-us/articles/4417082520724-What-are-public-and-private-keys-and-how-do-they-work-) to log out via the Magic API.

### Returns

* `Promise<void>`

### `logoutByToken`

Logs a user out of all client-side Magic SDK sessions given the user's DID token.

### Arguments

* `didToken` (String): A valid Decentralized ID Token generated client-side by a Magic user

### Returns

* `Promise<void>`

### Multichain Methods

The following multichain methods require the use of the enum `WalletType` that is exported from the Magic Admin SDK.

<Tabs>
<Tab title="Typescript">
```json
‚Å†enum WalletType {
  ETH = 'ETH',
  HARMONY = 'HARMONY',
  ICON = 'ICON',
  FLOW = 'FLOW',
  TEZOS = 'TEZOS',
  ZILLIQA = 'ZILLIQA',
  POLKADOT = 'POLKADOT',
  SOLANA = 'SOLANA',
  AVAX = 'AVAX',
  ALGOD = 'ALGOD',
  COSMOS = 'COSMOS',
  CELO = 'CELO',
  BITCOIN = 'BITCOIN',
  NEAR = 'NEAR',
  HELIUM = 'HELIUM',
  CONFLUX = 'CONFLUX',
  TERRA = 'TERRA',
  TAQUITO = 'TAQUITO',
  ED = 'ED',
  HEDERA = 'HEDERA',
  NONE = 'NONE',
  ANY = 'ANY',
}
```
</Tab>
</Tabs>

### `getMetadataByIssuerAndWallet`

Retrieves information about user, including their multichain wallets, by the supplied issuer.

### Arguments

* `issuer` (String): The user's Decentralized ID, which can be parsed using [`TokenModule.getIssuer`](#getissuer)
* `walletType` (WalletType): The wallet type. Must import `WalletType` from Admin SDK.

### Returns

* A `MagicUserMetadata`: The `data` field contains all of the user meta information.
    * `issuer` (String): The user's Decentralized ID
    * `publicAddress` (String): The authenticated user's public address (a.k.a.: public key). Currently, this value is associated with the Ethereum blockchain.
    * `email` (String): The user's email address
    * `phoneNumber` (String | null): The user's phone number
    * `oauthProvider` (String | null): OAuth provider, if any
    * `wallets` (Object\[\]): The multichain wallets of the authenticated user

### `getMetadataByPublicAddressAndWallet`

Retrieves information about user, including their multichain wallets, by the supplied public address.

### Arguments

* `publicAddress` (String): The user's Ethereum public address, which can be parsed using [`TokenModule.getPublicAddress`](#getpublicaddress)
* `walletType` (WalletType): The wallet type. Must import `WalletType` from Admin SDK.

### Returns

* A `MagicUserMetadata`: The `data` field contains all of the user meta information.
    * `issuer` (String): The user's Decentralized ID
    * `publicAddress` (String): The authenticated user's public address (a.k.a.: public key). Currently, this value is associated with the Ethereum blockchain.
    * `email` (String): The user's email address
    * `phoneNumber` (String | null): The user's phone number
    * `oauthProvider` (String | null): OAuth provider, if any
    * `wallets` (Object\[\]): The multichain wallets of the authenticated user

### `getMetadataByTokenAndWallet`

Retrieves information about user, including their multichain wallets, by the supplied DID Token.

### Arguments

* `didToken` (String): A valid Decentralized ID Token generated client-side by a Magic user
* `walletType` ( WalletType ): The wallet type. Must import `WalletType` from Admin SDK.

### Returns

* A `MagicUseMetadata`: The `data` field contains all of the user meta information.
    * `issuer` (String): The user's Decentralized ID
    * `publicAddress` (String): The authenticated user's public address (a.k.a.: public key). Currently, this value is associated with the Ethereum blockchain.
    * `email` (String): The user's email address
    * `phoneNumber` (String | null): The user's phone number
    * `oauthProvider` (String | null): OAuth provider, if any
    * `wallets` (Object\[\]): The multichain wallets of the authenticated user

## Utils Module

The Utils Module and it's members are accessible on the Magic Admin SDK instance by the `utils` property.

<Tabs>
<Tab title="Typescript">
```json

const { Magic } = require('@magic-sdk/admin');

const magic = new Magic();

magic.utils;
magic.utils.parseAuthorizationHeader;
```
</Tab>
</Tabs>

`parseAuthorizationHeader`

### Arguments

* `header` (String): A request authorization header passed in from the client-side application that looks like `Bearer WyIweG...n0iXQ==`

### Returns

* `string`: The DID token embedded in the authorization header ‚Å† _This is only available to Admin SDK version_ _**1.1.0**_ _and above._

## Errors & Warnings

### `SDKError`

The `SDKError` class is exposed for `instanceof` operations.

<Tabs>
<Tab title="Typescript">
```json

import { SDKError } from '@magic-sdk/admin';

try {
  // Something async...
catch (err) {
  if (err instanceof SDKError) {
    // Handle...
  }
}
```
</Tab>
</Tabs>

Additionally, an enumeration of relevant error codes is also exposed for convenience and human readability:

<Tabs>
<Tab title="Typescript">
```json

import { ErrorCode } from '@magic-sdk/admin';

ErrorCode.ApiKeyMissing;
ErrorCode.MissingAuthHeader;
ErrorCode.IncorrectSignerAddress;
// and so forth...
// Please reference the `Enum Key` column of the error table below.
```
</Tab>
</Tabs>

### Error Codes

|     |     |
| --- | --- |
| Enum Key | Description |
| `TokenExpired` | The supplied DID Token is invalid due to an expired timestamp. |
| `TokenCannotBeUsedYet` | The `nbf` ("not before") field of the supplied DID Token is set in the future. By default, a 5 minute leeway is added to the timestamp. |
| `IncorrectSignerAddress` | The supplied DID Token is invalid due to a mismatch between the signature origin and the claimed user public address. |
| `FailedRecoveryProof` | The supplied DID Token could not be recovered using Elliptic Curve recovery. |
| `ApiKeyMissing` | The API key required for a particular action is missing or malformed. |
| `MalformedTokenError` | The supplied DID Token could not be successfully parsed. |
| `ServiceError` | An error occurred while communicating with the Magic API. Be sure to check the `data` property of the error object for additional context. |
| `ExpectedBearerString` | The supplied DID token needs to be in the proper format of¬†`Bearer {token}` |
| `AudienceMismatch` | Audience does not match client ID. Please ensure your secret key matches the application which generated the DID token. |

### [#`data` & Nested Errors](#data-nested-errors)

For additional context about an error, the `SDKError.data` property contains an array of potentially illuminating metadata. At the moment, this property is reserved for service errors when communication to Magic APIs fail.

## Resources

* [GitHub](https://github.com/magiclabs/magic-admin-js/)
* [NPM](https://www.npmjs.com/package/@magic-sdk/admin)

## Versions

All changes to the SDK are covered in our [latest release notes](https://github.com/magiclabs/magic-admin-js/releases).

