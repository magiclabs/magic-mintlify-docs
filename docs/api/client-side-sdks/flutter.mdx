---
title: Flutter API Reference
sidebarTitle: Flutter
description: "The Magic SDK for Flutter is your entry-point to secure, passwordless authentication for your mobile app. This guide will cover some important topics for getting started with Flutter APIs and to make the most of Magic's features."
---

## Overview

## Getting Started

The Magic class is the entry-point to the Magic SDK. It must be instantiated with a Magic **publishable** key.

### Installation

Add `magic_sdk` to your `pubspec.yaml`:

<Tabs>
<Tab title="Yaml">
```json

dependencies:
  flutter:
    sdk: flutter
  magic_sdk: ^6.0.1
```
</Tab>
</Tabs>

Run the following command to install dependencies:

<Tabs>
<Tab title="Bash">
```json

$ dart pub get
```
</Tab>
</Tabs>

### Performance improvement (optional)

We use service workers for for better performance on web3 operations. They are enabled by default on Android, but if you'd like to take advantage of this performance boost on iOS as well, you'd have to enable app bound domains. To do that, add the following to your `Info.plist` and rebuild your app:

```json
<key>WKAppBoundDomains</key>
<array>
  <string>https://auth.magic.link</string>
</array>
```

### Constructor

### `Magic()`

`Magic(apiKey, {MagicLocale locale})`

|     |     |     |
| --- | --- | --- |
| Parameter | Type | Definition |
| `apiKey` | String | Your **publishable** API Key retrieved from the Magic Dashboard. |
| `locale?` | MagicLocale | Customize the language of Magic's modal, email and confirmation screen. See [Localization](/docs/authentication/customization/localization) for more. |

`Magic.eth(String apiKey, { required EthNetwork network, MagicLocale locale})`

|     |     |     |
| --- | --- | --- |
| Parameter | Type | Definition |
| `network` | EthNetwork | A representation of the connected Ethereum network (one of: mainnet or goerli). |

`Magic.custom(String apiKey, { required String rpcUrl, int? chainId, MagicLocale locale})`

|     |     |     |
| --- | --- | --- |
| Parameter | Type | Definition |
| `rpcUrl` | String | A URL pointing to your custom Ethereum Node. |
| `chainId?` | int | Some Node infrastructures require you to pass an explicit chain ID. If you are aware that your Node requires this configuration, pass it here as an integer. |

### Initialization

<Tabs>
<Tab title="Dart">
```json

import 'package:magic_sdk/magic_sdk.dart';

// Construct with an API key:
Magic.instance = Magic("PUBLISHABLE_API_KEY");

// Construct with an API key and locale:
Magic.instance = Magic("PUBLISHABLE_API_KEY", locale: MagicLocale.en_US);

// Construct with an API key and network:
Magic.instance = Magic.eth("PUBLISHABLE_API_KEY", network: EthNetwork.goerli);

// Construct with an API key and custom node options:
Magic.instance = Magic.custom("PUBLISHABLE_API_KEY", rpcUrl: "https://your.custom.url/", chainId: 1);

```
</Tab>
</Tabs>

## Auth Module

The Auth Module and its members are accessible on the Magic SDK instance by the `auth` property.

<Tabs>
<Tab title="Dart">
```json

import 'package:magic_sdk/magic_sdk.dart';

Magic magic = Magic.instance;

magic.auth;
magic.auth.loginWithSMS;
magic.auth.loginWithEmailOTP;
```
</Tab>
</Tabs>

### `loginWithSMS`

Authenticate a user passwordlessly using a one-time code sent to the specified phone number.

[List of Currently Blocked Country Codes](/docs/home/faq/dedicated-wallet#questions-around-sms)

### [#Public Methods](#public-methods)

`Future<String> loginWithSMS({ required String email })`

|     |     |     |
| --- | --- | --- |
| Parameter | Type | Definition |
| `phoneNumber` | String | The phone number to log in with. |

### Returns

* `Future<string>` The future resolves upon authentication request success and throws with a specific error code if the request fails. The resolved value is a Decentralized ID token with a default 15-minute lifespan.

### Example

<Tabs>
<Tab title="Dart">
```json

import 'package:magic_sdk/magic_sdk.dart';

Magic.instance = Magic("PUBLISHABLE_API_KEY");

// log in a user by using text input Controller
try {
  var magic = Magic.instance;
  await magic.auth.loginWithSMS(phoneNumber: textController.text);
} catch {
  // Handle errors if required!
}
```
</Tab>
</Tabs>

### `loginWithEmailOTP`

Authenticate a user passwordlessly using an email one-time code sent to the specified user's email address.

### Public Methods

`Future<String> loginWithEmailOTP({ required String email })`

|     |     |     |
| --- | --- | --- |
| Parameter | Type | Definition |
| `email` | String | The user email to log in with. |

### Returns

* `Future<string>` The future resolves upon authentication request success and throws with a specific error code if the request fails. The resolved value is a Decentralized ID token with a default 15-minute lifespan.

### Example

<Tabs>
<Tab title="Dart">
```json

import 'package:magic_sdk/magic_sdk.dart';

Magic.instance = Magic("PUBLISHABLE_API_KEY");

// log in a user by using text input Controller
try {
  var magic = Magic.instance;
  await magic.auth.loginWithEmailOTP(email: textController.text);
} catch {
  // Handle errors if required!
}
```
</Tab>
</Tabs>

## User Module

The User Module and it's members are accessible on the Magic SDK instance by the user property.

<Tabs>
<Tab title="Dart">
```json

import 'package:magic_sdk/magic_sdk.dart';

Magic.instance = Magic("PUBLISHABLE_API_KEY");

var m = Magic.instance;

m.user;
m.user.getIdToken;
m.user.generateIdToken;
m.user.getInfo;
m.user.isLoggedIn;
m.user.updateEmail;
m.user.logout;
```
</Tab>
</Tabs>

### `updateEmail`

Initiates the update email flow that allows a user to change their email address.

### Arguments

`Future<bool> updateEmail({required String email, bool showUI = true})`

|     |     |     |
| --- | --- | --- |
| Parameter | Type | Definition |
| `email` | String | The new email to update to. |
| `showUI?` | Boolean | If `true`, shows an out-of-the-box pending UI which includes instructions on which step of the confirmation process the user is on. Dismisses automatically when the process is complete. |

### Returns

* `Future<boolean>`: The future resolves with a true boolean value if update email is successful and rejects with a specific error code if the request fails

### Example

<Tabs>
<Tab title="Dart">
```json

import 'package:magic_sdk/magic_sdk.dart';

Magic.instance = Magic("PUBLISHABLE_API_KEY");

// Initiates the flow to update a user's current email to a new one.
try {
  var magic = Magic.instance;

  /* Assuming user is logged in */
  await magic.user.updateEmail(email: 'new_user_email@example.com');
} catch {
  // Handle errors if required!
}

/**
 * Initiates the flow to update a user's current email to a new one,
 * without showing an out-of-the box UI.
 */
try {
  var magic = Magic.instance;

  /* Assuming user is logged in */
  await magic.user.updateEmail({ email: 'new_user_email@example.com', showUI: false });
} catch {
  // Handle errors if required!
}
```
</Tab>
</Tabs>

### `getIdToken`

Generates a [Decentralized Id Token](/docs/authentication/features/decentralized-id) which acts as a proof of authentication to resource servers.

### Arguments

`Future<String> getIdToken({int lifespan = 900})`

|     |     |     |
| --- | --- | --- |
| Parameter | Type | Definition |
| `lifespan?` | int | Will set the lifespan of the generated token. Defaults to 900s (15 mins) |

### Returns

* `Future<string>`: Base64-encoded string representation of a JSON tuple representing `[proof, claim]`

### Example

<Tabs>
<Tab title="Dart">
```json

import 'package:magic_sdk/magic_sdk.dart';

Magic.instance = Magic("PUBLISHABLE_API_KEY");

// Assumes a user is already logged in
try {
  var m = Magic.instance;
  const idToken = await m.user.getIdToken();
} catch {
  // Handle errors if required!
}
```
</Tab>
</Tabs>

### `generateIdToken`

Generates a [Decentralized Id Token](/docs/authentication/features/decentralized-id) with optional serialized data.

### Arguments

`Future<String> generateIdToken({int lifespan = 900, String attachment = 'none'})`

|     |     |     |
| --- | --- | --- |
| Parameter | Type | Definition |
| `lifespan?` | int | Will set the lifespan of the generated token. Defaults to 900s (15 mins) |
| `attachment?` | String | Will set a signature of serialized data in the generated token. Defaults to `"none"` |

### Returns

* `Future<string>`: Base64-encoded string representation of a JSON tuple representing `[proof, claim]`

### Example

<Tabs>
<Tab title="Dart">
```json

import 'package:magic_sdk/magic_sdk.dart';

Magic.instance = Magic("PUBLISHABLE_API_KEY");

// Assumes a user is already logged in
try {
  var m = Magic.instance;

  const idToken = await m.user.generateIdToken({ attachment: 'SERVER_SECRET' });
} catch {
  // Handle errors if required!
}
```
</Tab>
</Tabs>

### `getInfo`

Retrieves information for the authenticated user.

### Arguments

* _None_

### Returns

* `Future<UserInfo>`: an object containing the issuer, email and cryptographic public address of the authenticated user

|     |     |     |
| --- | --- | --- |
| Value | Type | Definition |
| `issuer` | String | The Decentralized ID of the user. In server-side use-cases, we recommend this value to be used as the user ID in your own tables. |
| `email` | String | Email address of the authenticated user. |
| `publicAddress` | String | The authenticated user's public address (a.k.a.: public key). Currently, this value is associated with the Ethereum blockchain. |
| `isMfaEnabled` | Boolean | A boolean indicating if user has multi-factor authentication enabled. |
| `recoveryFactors` | * `List<RecoveryFactor>`<br/>    * `value`<br/>    * `type` |     |

### Example

<Tabs>
<Tab title="Dart">
```json

import 'package:magic_sdk/magic_sdk.dart';

Magic.instance = Magic("PUBLISHABLE_API_KEY");

// Assumes a user is already logged in
try {
  var m = Magic.instance
  await m.user.getInfo();
} catch {
  // Handle errors if required!
}
```
</Tab>
</Tabs>

### `isLoggedIn`

Checks if a user is currently logged in to the Magic SDK.

### Arguments

* _None_

### Returns

* `Future<Boolean>`

### Example

<Tabs>
<Tab title="Dart">
```json

import 'package:magic_sdk/magic_sdk.dart';

Magic.instance = Magic("PUBLISHABLE_API_KEY");

try {
  const isLoggedIn = await m.user.isLoggedIn();
  debugPrint(isLoggedIn); // => `true` or `false`
} catch {
  // Handle errors if required!
}
```
</Tab>
</Tabs>

### `logout`

Logs out the currently authenticated Magic user

### Arguments

* _None_

### Returns

* `Future<Boolean>`

### Example

<Tabs>
<Tab title="Dart">
```json

import { Magic } from 'magic-sdk';

const m = new Magic('PUBLISHABLE_API_KEY');

try {
  await m.user.logout();
  debugPrint(await m.user.isLoggedIn()); // => `false`
} catch {
  // Handle errors if required!
}
```
</Tab>
</Tabs>

## OAuth Module

The OAuth Module and it's members are accessible on the Magic SDK instance by the `oauth` property.

<Tabs>
<Tab title="Dart">
```json
import 'package:magic_sdk/magic_sdk.dart';
import 'package:magic_ext_oauth/magic_ext_oauth.dart';

Magic magic = Magic.instance;

magic.oauth;
magic.oauth.loginWithPopup;
```
</Tab>
</Tabs>

### `loginWithPopup`

Starts the OAuth 2.0 login flow.

<Note>
Only available with Dedicated Wallet.
</Note>
### Arguments

* `provider` (String): The OAuth provider being used for login
* `redirectURI` (String): A URL a user is sent to after they successfully log in
* `scope?` (Array): Defines the specific permissions an application requests from a user

### Returns

* _None_

### [#Valid Providers](#valid-providers)

|     |     |
| --- | --- |
| Name | Argument |
| Google | `'google'` |
| Facebook | `'facebook'` |
| Twitter | `'twitter'` |
| Apple | `'apple'` |
| Discord | `'discord'` |
| GitHub | `'github'` |
| LinkedIn | `'linkedin'` |
| Bitbucket | `'bitbucket'` |
| GitLab | `'gitlab'` |
| Twitch | `'twitch'` |
| Microsoft | `'microsoft'` |

### Example

Dart

<Tabs>
<Tab title="">
```json
import 'package:magic_sdk/magic_sdk.dart';
import 'package:magic_ext_oauth/magic_ext_oauth.dart';

Magic.instance = Magic("YOUR_PUBLISHABLE_KEY");
Magic magic = Magic.instance;

var configuration = OAuthConfiguration(provider: OAuthProvider.GITHUB, redirectURI: 'YOUR_APP_SCHEME://');
var result = await magic.oauth.loginWithPopup(configuration);
```
</Tab>
</Tabs>

## OpenID Module

<Note>
This module requires an enterprise agreement. For more details [click here](docs/authentication/login/idp).
</Note>

The OpenID Module and it's members are accessible on the Magic Flutter SDK instance by the `openid` property.

To use the OpenID Module in your application, install `magic-ext/oidc` along with `magic-sdk`.

<Tabs>
<Tab title="Dart">
```json
# pubspec.yaml
dependencies:
  flutter:
    sdk: flutter
  magic_sdk: ^5.0.1
  magic_ext_oidc: ^0.0.1

magic.openid;
magic.openid.loginWithOIDC;
```
</Tab>
</Tabs>

### `loginWithOIDC`

Authenticate users via your preferred OIDC client.

<Note>
Only available with Dedicated Wallet.
</Note>

### Arguments

* `jwt` (String): The OIDC token from your identity provider

* `providerId` (String): An alphanumeric ID provided by Magic after successful configuration of your identity provider


### Returns

* `String`: The resolved value is a Decentralized ID token with a default 15-minute lifespan


### Example

<Tabs>
<Tab title="Dart">
```json

import 'package:magic_sdk/magic_sdk.dart';
import 'package:magic_ext_oidc/magic_ext_oidc.dart';

void main() {
  Magic.instance = Magic("PUBLISHABLE_API_KEY");

  // Use the OIDC extension to perform login
  var configuration = OpenIdConfiguration(
       jwt: 'JWT_FROM_YOUR_OPEN_ID_PROVIDER',
⁠       providerId:'YOUR_MAGIC_PROVIDER_ID');
⁠
  var didToken = await magic.openid.loginWithOIDC(configuration);

  // Use the DID token for further authentication or requests
  print('DID Token: $didToken');
}
```
</Tab>
</Tabs>

## Resources

* [GitHub](https://github.com/magiclabs/magic-flutter)
* ⁠[Demo](https://github.com/magiclabs/magic-flutter/tree/main/magic_demo)
* [Goerli Testnet Faucet](https://goerlifaucet.com)


