---
title: Product Security
---

# Background

Magic’s goal is to meet companies wherever they are on the path to Web3 adoption—from exploring authentication options to fully integrating with a blockchain, Magic provides solutions that developers and enterprises alike can trust. Our mission to onboard the next billion users to Web3 is not just a catchphrase, it’s a foundation that affects how we address security at every aspect of the user journey.

## Why use Magic?

### Password leaks are prevalent.

Companies that have a database with passwords are a high-value target for hackers, who have successfully breached companies of all sizes.

### Magic doesn’t use passwords; there's another option.

Passwords are only one (obsolete) way to handle authentication. Magic utilizes one-time passcodes to grant access. Delivered through email, these passcodes are time-bound tokens that enable authentication without having to store and maintain passwords. Optionally, Magic also partners with social providers to leverage cross-platform authentication for our products.

## What about phishing?

### Phishing is an ever-present threat on the internet

Since the creation of the internet, hackers have leveraged phishing to direct victims to authentic-looking pages to attack them or steal their credentials. Hackers can craft incredibly realistic pages, utilize social engineering to entice victims to connect, and capture credentials for later use in direct attacks or credential-stuffing attacks elsewhere on the internet.

### Magic’s approach makes phishing more difficult

Magic’s approach to authentication makes phishing much more difficult. Because Magic uses time-bound tokens, any credentials captured from successful phishing attacks have the same limited shelf life. Magic’s innovative approach to device registration for authentication, for customers who wish to take advantage of it, dramatically increases the difficulty of phishing attempts.

## With no passwords, how do you determine identity?

### The “Magic” of public-private key pairs

Once an end-user uses their time-bound token to establish a session with Magic, Magic generates a key pair based on the [Ethereum](https://en.wikipedia.org/wiki/Ethereum) blockchain. The public key acts as an identifier for the user. Leveraging elliptic curve cryptography, the private key is used to generate a verifiable proof of identification and authorization from a claim. The proof is then sent to the developer application servers where data in the claim can be recovered, and the authenticity of the request can be ensured. 

Authentication and authorization are achieved without requiring user passwords. The claim format is an adaptation of the W3C [Decentralized Identifiers](https://w3c-ccg.github.io/did-primer/) (DID) protocol. Learn More about Magic DID's [here](/embedded-wallets/authentication/features/decentralized-id).

## Private keys can be lost or stolen. How do you protect my private key?

### Next-generation key management

With this public–private key-pair approach, it is critical to ensure that users’ private keys are properly secured. That’s what our TEE Key Management System (TKMS) is designed for. Building on the success of our earlier DKMS, which has safeguarded millions of private keys for thousands of companies, TKMS takes key security to the next level. By leveraging distributed key shards, Trusted Execution Environments (TEEs), and AWS KMS, Magic delivers private key management that is secure, scalable, and resilient, all backed by best-in-class cryptography standards.

## How does TKMS work?

Magic provides infrastructure that manages sharded private keys instead of a single encrypted key. The key is split using Shamir’s Secret Sharing (SSS) across Magic, or optionally the Dapp/Developer depending on thesecurity requirements. Each shard is additionally encrypted and secured in Trusted Execution Environments (TEEs) with AWS KMS.

When an operation like signing is requested, shards are retrieved and securely recombined inside the TEE, never leaving hardware isolation. The private key only exists ephemerally in memory for the operation, and only the signed result is returned.

## Wait, another encryption key!? Can't that one get stolen?

### User passwords provide additional security layer

The TEE Key Management System requires user passwords as an additional security layer beyond hardware-level protection. These passwords work in combination with the TEE attestation and external shards to ensure maximum security.

**Password origin and flow:**

1. **Client Application** - Users enter their password in frontend or mobile applications
2. **API Requests** - Passwords are sent as the `encryption_context` field in all API calls to the TEE service
3. **Server Processing** - The backend service passes the password to the enclave as a parameter
4. **TEE Enclave** - The password is used to decrypt shard C1 for private key reconstruction

**Security properties:**

- **Never stored** - Passwords are never stored anywhere in the TEE system
- **Required for operations** - Every private key operation requires the correct password
- **Immediate failure** - Wrong passwords result in immediate failure with clear error messages
- **Multi-layer protection** - Works in combination with KMS attestation and external shards

This design ensures that even if the TEE system is compromised, private keys cannot be accessed without the user's password, providing an additional layer of security beyond hardware-level protection. The password requirement means that user consent and knowledge are always required for any private key operations.
